!function(){var t={};this.tmpl=function(e,n){var o=/[^A-Za-z0-9_-]/.test(e)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%})/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/{%=(.+?)%}/g,"',$1,'").split("{%").join("');").split("%}").join("p.push('")+"');}return p.join('');"):t[e]=t[e]||tmpl(document.getElementById(e).innerHTML);return n?o(n):o}}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}((function(t){t.timeago=function(e){return e instanceof Date?i(e):i("string"==typeof e?t.timeago.parse(e):"number"==typeof e?new Date(e):t.timeago.datetime(e))};var e=t.timeago;t.extend(t.timeago,{settings:{refreshMillis:6e4,allowPast:!0,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"önce",suffixFromNow:"şimdi",inPast:"şimdi",seconds:"az",minute:"%d dakika",minutes:"%d dakika",hour:"%d saat",hours:"%d saat",day:"%d gün",days:"%d gün",month:"%d ay",months:"%d ay",year:"%d yıl",years:"%d yıl",wordSeparator:" ",numbers:[]}},inWords:function(e){if(!this.settings.allowPast&&!this.settings.allowFuture)throw"timeago allowPast and allowFuture settings can not both be set to false.";var n=this.settings.strings,o=n.prefixAgo,i=n.suffixAgo;if(this.settings.allowFuture&&e<0&&(o=n.prefixFromNow,i=n.suffixFromNow),!this.settings.allowPast&&e>=0)return this.settings.strings.inPast;var s=Math.abs(e)/1e3,a=s/60,r=a/60,l=r/24,d=l/365;function m(o,i){var s=t.isFunction(o)?o(i,e):o,a=n.numbers&&n.numbers[i]||i;return s.replace(/%d/i,a)}var p=s<45&&m(n.seconds,Math.round(s))||s<90&&m(n.minute,1)||a<45&&m(n.minutes,Math.round(a))||a<90&&m(n.hour,1)||r<24&&m(n.hours,Math.round(r))||r<42&&m(n.day,1)||l<30&&m(n.days,Math.round(l))||l<45&&m(n.month,1)||l<365&&m(n.months,Math.round(l/30))||d<1.5&&m(n.year,1)||m(n.years,Math.round(d)),h=n.wordSeparator||"";return void 0===n.wordSeparator&&(h=" "),t.trim([o,p,i].join(h))},parse:function(e){var n=t.trim(e);return n=(n=(n=(n=(n=n.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2")).replace(/([\+\-]\d\d)$/," $100"),new Date(n)},datetime:function(n){var o=e.isTime(n)?t(n).attr("datetime"):t(n).attr("title");return e.parse(o)},isTime:function(e){return"time"===t(e).get(0).tagName.toLowerCase()}});var n={init:function(){var n=t.proxy(o,this);n();var i=e.settings;i.refreshMillis>0&&(this._timeagoInterval=setInterval(n,i.refreshMillis))},update:function(n){var i=e.parse(n);t(this).data("timeago",{datetime:i}),e.settings.localeTitle&&t(this).attr("title",i.toLocaleString()),o.apply(this)},updateFromDOM:function(){t(this).data("timeago",{datetime:e.parse(e.isTime(this)?t(this).attr("datetime"):t(this).attr("title"))}),o.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};function o(){var n=function(n){if(!(n=t(n)).data("timeago")){n.data("timeago",{datetime:e.datetime(n)});var o=t.trim(n.text());e.settings.localeTitle?n.attr("title",n.data("timeago").datetime.toLocaleString()):!(o.length>0)||e.isTime(n)&&n.attr("title")||n.attr("title",o)}return n.data("timeago")}(this),o=e.settings;return isNaN(n.datetime)||(0==o.cutoff||Math.abs(s(n.datetime))<o.cutoff)&&t(this).text(i(n.datetime)),this}function i(t){return e.inWords(s(t))}function s(t){return(new Date).getTime()-t.getTime()}t.fn.timeago=function(t,e){var o=t?n[t]:n.init;if(!o)throw new Error("Unknown function name '"+t+"' for timeago");return this.each((function(){o.call(this,e)})),this},document.createElement("abbr"),document.createElement("time")})),function(t,e){if("function"==typeof define&&define.amd)define(["exports","module"],e);else if("undefined"!=typeof exports&&"undefined"!=typeof module)e(exports,module);else{var n={exports:{}};e(n.exports,n),t.autosize=n.exports}}(this,(function(t,e){"use strict";function n(t){if(t&&t.nodeName&&"TEXTAREA"===t.nodeName){var e=document.createEvent("Event");e.initEvent("autosize:destroy",!0,!1),t.dispatchEvent(e)}}function o(t){if(t&&t.nodeName&&"TEXTAREA"===t.nodeName){var e=document.createEvent("Event");e.initEvent("autosize:update",!0,!1),t.dispatchEvent(e)}}var i=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((i=function(t){return t}).destroy=function(t){return t},i.update=function(t){return t}):((i=function(t,e){return t&&Array.prototype.forEach.call(t.length?t:[t],(function(t){return function(t){function e(){var e=window.getComputedStyle(t,null);"vertical"===e.resize?t.style.resize="none":"both"===e.resize&&(t.style.resize="horizontal"),m="content-box"===e.boxSizing?-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)):parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth),i()}function n(e){var n=t.style.width;t.style.width="0px",t.offsetWidth,t.style.width=n,p=e,d&&(t.style.overflowY=e),o()}function o(){var e=window.pageYOffset,n=document.body.scrollTop,o=t.style.height;t.style.height="auto";var i=t.scrollHeight+m;return 0===t.scrollHeight?void(t.style.height=o):(t.style.height=i+"px",document.documentElement.scrollTop=e,void(document.body.scrollTop=n))}function i(){var e=t.style.height;if(o(),window.getComputedStyle(t,null).height!==t.style.height?"visible"!==p&&n("visible"):"hidden"!==p&&n("hidden"),e!==t.style.height){var i=document.createEvent("Event");i.initEvent("autosize:resized",!0,!1),t.dispatchEvent(i)}}var s=void 0===arguments[1]?{}:arguments[1],a=s.setOverflowX,r=void 0===a||a,l=s.setOverflowY,d=void 0===l||l;if(t&&t.nodeName&&"TEXTAREA"===t.nodeName&&!t.hasAttribute("data-autosize-on")){var m=null,p="hidden",h=function(e){window.removeEventListener("resize",i),t.removeEventListener("input",i),t.removeEventListener("keyup",i),t.removeAttribute("data-autosize-on"),t.removeEventListener("autosize:destroy",h),Object.keys(e).forEach((function(n){t.style[n]=e[n]}))}.bind(t,{height:t.style.height,resize:t.style.resize,overflowY:t.style.overflowY,overflowX:t.style.overflowX,wordWrap:t.style.wordWrap});t.addEventListener("autosize:destroy",h),"onpropertychange"in t&&"oninput"in t&&t.addEventListener("keyup",i),window.addEventListener("resize",i),t.addEventListener("input",i),t.addEventListener("autosize:update",i),t.setAttribute("data-autosize-on",!0),d&&(t.style.overflowY="hidden"),r&&(t.style.overflowX="hidden",t.style.wordWrap="break-word"),e()}}(t,e)})),t}).destroy=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],n),t},i.update=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],o),t}),e.exports=i})),function(t){"use strict";var e=function(t){return window.i18n[t]||t};window.Comments=function(e,n){this.element=e,this.options=t.extend({},Comments.defaults,n),this.initOptions(),this.bindEvents()},Comments.defaults={storageKey:"comment_author",commentTemplateId:"commentTemplate",paginationTemplateId:"paginationTemplate",messages:{comment:"1 "+e("Comment"),comments:"{num} "+e("Comment"),nocomments:e("No comments yet"),error:"Opps!"}},Comments.prototype.initOptions=function(){var e=this.options,n=this.element;e.list=n.find(".list-comments"),e.form=n.find("form"),e.sort=n.find(".sort"),e.total=n.find(".comment-total"),e.placeholder=n.find(".placeholder"),e.pagination=n.find(".pagination-container"),e.currentPage=this.getParam("page",1),e.linkedComment=this.getParam("comment",0),t.ajaxSetup({headers:{"X-CSRF-TOKEN":this.options.csrfToken}})},Comments.prototype.bindEvents=function(){var t=this.options;t.placeholder.on("click",this.showForm.bind(this)),t.form.find(".cancel").on("click",this.hideForm.bind(this)),this.element.on("keyup","textarea",this.characterCount.bind(this)),this.element.on("click",".captcha img",this.refreshCaptcha.bind(this)),t.pagination.on("click","a",this.pageClick.bind(this)),this.element.on("submit",".post-form",this.formSubmit.bind(this)),t.sort.on("click","a",this.sort.bind(this)),t.list.on("click",".reply",this.showReplyForm.bind(this)),t.list.on("click",".time, .parent",this.setLinkedComment.bind(this)),t.list.on("click",".collapse, .expand",this.toggleComment.bind(this)),t.list.on("click",".like, .dislike",this.vote.bind(this)),t.list.on("click",".quick-edit",this.showEditForm.bind(this)),t.list.on("submit",".edit-form",this.submitEditForm.bind(this)),t.list.on("click",".edit-form .cancel",this.hideEditForm.bind(this)),t.list.on("click",".list-more",this.showComments.bind(this)),t.list.on("click",".spoiler-btn",this.showSpoiler.bind(this)),this.selectSort(),this.loadComments()},Comments.prototype.showForm=function(t){this.getAuthor(this.options.form),this.options.placeholder.hide(),this.options.form.show(),autosize(this.options.form.find("textarea"))},Comments.prototype.hideForm=function(){this.options.form.hide(),this.clearForm(this.options.form),this.options.placeholder.show(),autosize.destroy(this.options.form.find("textarea"))},Comments.prototype.characterCount=function(e){var n=t(e.target),o=n.closest("form"),i=n.val(),s=parseInt(n.attr("maxlength"))||0;s&&(i.length>s?(n.val(i.substr(0,s)),o.find(".character-count").text(0)):o.find(".character-count").text(s-i.length))},Comments.prototype.refreshCaptcha=function(){var t=this.element.find(".captcha img");t.length&&(this.element.find('input[name="captcha"]').val(""),this.ajax("GET","captcha",{}).done((function(e){t.attr("src",e)})))},Comments.prototype.pageClick=function(e){e.preventDefault();var n=t(e.currentTarget).parent(),o=t(e.currentTarget).data("page");if(n.hasClass("disabled")||n.hasClass("active"))return e.preventDefault(),!1;window.location.hash="#!page="+o,t("body, html").animate({scrollTop:this.options.list.offset().top-20},400),this.options.currentPage=o,this.options.linkedComment=0,this.loadComments()},Comments.prototype.formSubmit=function(e){e.preventDefault();var n=this,o=t(e.target),i=o.serialize(),s=this.options.list,a=o.parents(".list-comment").length+1;o.find('input[name="parent_id"]').val().length&&(s=o.parent().parent().parent().next(".list-comments").first()),o.find(".response").hide(),this.disable(o),this.ajax("POST",i).done((function(e){var i=n.renderComment(e,null,a);i.prependTo(s),n.highlight(i),n.setTotal(n.options.total.data("total")+1),e.author.id||n.setAuthor(t.extend(e.author,{name:name})),o[0].reset(),o.find('input[name="parent_id"]').val().length&&o.find(".cancel").trigger("click")})).fail((function(t){n.alert(t.responseJSON||n.trans("error"),o)})).always((function(){n.enable(o)}))},Comments.prototype.sort=function(e){e.preventDefault(),this.options.currentPage=1,this.options.linkedComment=0,this.options.sortBy=t(e.currentTarget).attr("data-sort"),this.selectSort(),this.loadComments()},Comments.prototype.selectSort=function(){this.options.sort.find(".current").text(this.options.sort.find('[data-sort="'+this.options.sortBy+'"]').text()),this.options.sort.find("li").removeClass("selected"),this.options.sort.find('[data-sort="'+this.options.sortBy+'"]').parent().addClass("selected")},Comments.prototype.loadComments=function(){var t=this,e={page:this.options.currentPage,content_id:this.options.content,type:this.options.type,linked:this.options.linkedComment,sort:this.options.sortBy},n=function(){t.element.find(".loader").toggle()};n(),this.ajax("GET","get",e).done((function(e){t.options.list.fadeOut(0,(function(){t.options.list.html(""),t.renderComments(e.comments,t.options.list),t.highlight(t.options.list),t.options.list.find(".list").show(),t.options.list.fadeIn(0,(function(){t.options.linkedComment&&t.scrollToComment(t.options.linkedComment)}))})),t.renderPagination(e)})).always(n)},Comments.prototype.renderComments=function(e,n,o,i){var s,a;for(s in i=i||1,e)(a=this.renderComment(e[s],o,i)).appendTo(n),e[s].id===this.options.linkedComment&&a.find(".linked").show(),e[s].replies&&(e[s].replies.length>2&&t('<a href="javascript:;" class="list-more" data-parent="'+e[s].id+'">'+e[s].replies.length+" <span>yanıtı görüntüle</span> </a>").appendTo(a.find(".list-comments")),o||(e[s].replies=this.hierarchical(e[s].replies,e[s].id)),this.renderComments(e[s].replies,a.find(".list-comments"),e[s],i+1),a.find(".list-comments").children("li:gt(1)").addClass("list-hide"))},Comments.prototype.hierarchical=function(t,e){var n,o,i=[];for(n in t)t[n].parent_id===e&&((o=t[n]).replies=this.hierarchical(t,o.id),i.push(o));return i},Comments.prototype.renderComment=function(t,e,n){t.parent=e,t.reply=this.options.replies,this.options.maxDepth&&n>this.options.maxDepth&&(t.reply=!1);var o=this.renderTemplate(t,this.options.commentTemplateId);return o.find(".timeago").timeago(),o},Comments.prototype.renderPagination=function(t){this.setTotal(t.total?t.total:0);var e=t.pagination;!e||!e.per_page||e.total<=e.per_page||this.options.pagination.html(this.renderTemplate(e,this.options.paginationTemplateId))},Comments.prototype.setTotal=function(t){var e=t?1===t?this.trans("comment"):this.trans("comments",{num:t}):this.trans("nocomments"),n=this.options;0==t?n.sort.hide():n.sort.show(),this.options.total.text(e).data("total",t).show()},Comments.prototype.toggleComment=function(e){t(e.currentTarget).closest(".list-comment").toggleClass("collapsed")},Comments.prototype.vote=function(e){e.preventDefault();var n,o=t(e.currentTarget),i=o.parent(),s=t(e.currentTarget).parent().parent().parent().find(".replybox"),a=i.find(".like"),r=i.find(".dislike"),l=i.find(".likes"),d=i.find(".dislikes"),m=parseInt(l.data("votes")),p=parseInt(d.data("votes")),h=function(t){l.data("votes",t).text(t||"")},c=function(t){d.data("votes",t).text(t||"")};if(0===this.options.form.length)return s.html(this.renderTemplate({message:'Yorum alanı sadece üyelere özeldir. <a href="'+_URL+'/oturum-ac">Oturum aç</a> veya <a href="'+_URL+'/kaydol">Kaydol</a>'},"alertTemplate")).slideDown(200),!1;o.hasClass("like")?o.hasClass("voted")?(o.removeClass("voted"),h(m-1),n="-up"):(n="up",r.hasClass("voted")&&(r.removeClass("voted"),c(p-1)),o.addClass("voted"),h(m+1)):o.hasClass("voted")?(o.removeClass("voted"),c(p-1),n="-down"):(n="down",a.hasClass("voted")&&(a.removeClass("voted"),h(m-1)),o.addClass("voted"),c(p+1)),this.ajax("POST","vote",{id:i.closest(".list-comment").data("id"),type:n})},Comments.prototype.showReplyForm=function(e){e.preventDefault();var n=t(e.currentTarget).parent().parent().parent().find(".replybox"),o=(t(e.currentTarget).data("id"),t(e.currentTarget).data("parent"));if(n.html().length)return n.find(".cancel").trigger("click");0===this.options.form.length&&n.html(this.renderTemplate({message:'Yorum alanı sadece üyelere özeldir. <a href="'+_URL+'/oturum-ac">Oturum aç</a> veya <a href="'+_URL+'/kaydol">Kaydol</a>'},"alertTemplate")).slideDown(200);var i=this.options.form.clone();i.find(".cancel").bind("click",this.hideReplyForm.bind(this)),this.clearForm(i),i.appendTo(n),i.find('input[name="parent_id"]').val(o),i.find('input[name="spoiler"]').attr("id",o),i.find(".custom-control-label").attr("for",o),this.getAuthor(i),i.show(),autosize(i.find("textarea"))},Comments.prototype.hideReplyForm=function(e){t(e.target).closest("form").remove()},Comments.prototype.showEditForm=function(e){e.preventDefault();var n=t(e.currentTarget).closest(".list-body"),o=n.find(".edit-form"),i=o.find("textarea");n.find(".text").hide(),i.val(i.data("content")),o.show(),autosize(i)},Comments.prototype.showComments=function(e){e.preventDefault();var n=e.currentTarget;t(n).hasClass("less")?(t(n).removeClass("less"),t(n).find("span").text("yanıtı göster"),t('.list-comments[data-parent="'+t(n).attr("data-parent")+'"]').children("li:gt(1)").addClass("list-hide")):(t(n).addClass("less"),t(n).find("span").text("yanıtı gizle"),t('.list-comments[data-parent="'+t(n).attr("data-parent")+'"] li').removeClass("list-hide"))},Comments.prototype.showSpoiler=function(e){e.preventDefault();var n=t(e.currentTarget),o=n.attr("data-id");n.hide(),t('.list-comment[data-id="'+o+'"]').removeClass("spoiler")},Comments.prototype.hideEditForm=function(e){var n=t(e.currentTarget).closest(".list-body");n.find(".edit-form").hide(),n.find(".text").show()},Comments.prototype.submitEditForm=function(e){e.preventDefault();var n=this,o=t(e.target),i=o.serialize(),s=o.closest(".list-body"),a=s.find(".text");o.find(".response").hide(),this.disable(o),this.ajax("POST",i).done((function(t){a.html(t.comment),o.find("textarea").data("content",t.comment),n.highlight(a),n.hideEditForm(e),"1"!==t.status&&(s.find(".on-hold").addClass("show"),s.find(".edit-menu").remove())})).fail((function(t){n.alert(t.responseJSON||n.trans("error"),o)})).always((function(){n.enable(o)}))},Comments.prototype.clearForm=function(t){t.find(".response").hide(),t.find('input[type="text"], textarea').val(""),t.find(".character-count").text(t.find("textarea").attr("maxlength"))},Comments.prototype.setLinkedComment=function(e){e.preventDefault();var n=t(e.currentTarget);if(n.data("parent"))var o=this.options.list.find('[data-id="'+n.data("parent")+'"]');else o=n.closest(".list-comment");window.location.hash="#!comment="+o.data("id"),this.options.list.find(".linked").hide(),o.find(".linked").first().show()},Comments.prototype.scrollToComment=function(e){e instanceof t||(e=this.options.list.find('[data-id="'+e+'"]')),e.length&&t("body, html").animate({scrollTop:e.offset().top-20},100)},Comments.prototype.alert=function(t,e){e.find(".response").html(this.renderTemplate({message:t},"alertTemplate")).fadeIn(0)},Comments.prototype.ajax=function(e,n,o){return o?o.action=n:o=n,t.ajax({url:this.options.ajaxUrl,type:e,data:o,dataType:"json"})},Comments.prototype.getParam=function(t,e){var n,o=this.extractParam("_escaped_fragment_",location.search);return n=o?this.extractParam(t,"#"+o,!0):this.extractParam(t,window.location.hash.replace("#!","#"),!0),parseInt(n)||e},Comments.prototype.extractParam=function(t,e,n){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp((n?"[\\#]":"[\\?&]")+t+"=([^&#]*)").exec(e);return o?decodeURIComponent(o[1].replace(/\+/g," ")):null},Comments.prototype.setAuthor=function(t){t={name:t.name,email:t.email,url:t.url},window.localStorage.setItem(this.options.storageKey,JSON.stringify(t))},Comments.prototype.getAuthor=function(t){var e=window.localStorage.getItem(this.options.storageKey);try{e=JSON.parse(e)}catch(t){}e&&(t.find('input[name="author_name"]').val(e.name),t.find('input[name="author_email"]').val(e.email),t.find('input[name="author_url"]').val(e.url))},Comments.prototype.renderTemplate=function(e,n){return t(tmpl(n,e))},Comments.prototype.trans=function(e,n){return e=this.options.messages[e]||e.toString(),n&&t.each(n,(function(t,n){e=e.replace("{"+t+"}",n)})),e},Comments.prototype.highlight=function(e){window.Prism&&t("pre code").each((function(t,e){Prism.highlightElement(e)}))},Comments.prototype.disable=function(e,n){n=void 0===n||n,e.find("button, input, textarea").prop("disabled",n),t.fn.button&&e.find('button[type="submit"]').button(n?"loading":"reset")},Comments.prototype.enable=function(t){this.disable(t,!1)}}(jQuery);
